<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Mascotas</title>
		<link href="../dist/css/styles.css" rel="stylesheet" />
	</head>
	<body>
		<header class="m-2">
			<nav class="flex items-center justify-between">
				<a href="../index.html" class="flex items-center gap-3">
					<img
						src="../assets/img/logo.png"
						alt="logo de adoptame"
						class="h-10"
					/>
					<p class="font-montserrat font-bold">Adoptame</p>
				</a>
				<ul class="flex flex-col gap-2 font-roboto sm:flex-row sm:gap-2">
					<li>
						<a class="underline-offset-1 hover:underline" href="">
							Sobre nosotros
						</a>
					</li>
					<li>
						<a
							class="underline-offset-1 hover:underline"
							href="./protectoras.html"
						>
							Protectoras
						</a>
					</li>
					<li>
						<a class="underline-offset-1 hover:underline" href="./mascotas.html"
							>Mascotas</a
						>
					</li>
				</ul>
				<a
					href="./index.html"
					class="rounded-full border-2 border-customBlue px-6 py-2 font-roboto font-bold text-black transition duration-300 hover:bg-customBlue hover:text-white"
				>
					Iniciar sesión
				</a>
			</nav>
		</header>

		<main>
			<section
				class="flex h-64 w-full items-center justify-center bg-[url('http://127.0.0.1:5500/assets/img/huellas.png')] bg-cover bg-center"
			>
				<div
					class="flex w-[90%] max-w-2xl items-end gap-4 rounded-lg bg-black/80 p-6 backdrop-blur-md"
				>
					<div class="flex w-full flex-col gap-4 md:flex-row">
						<div class="w-full">
							<label for="tipo" class="block text-sm font-semibold text-white"
								>Tipo de mascota</label
							>
							<select
								id="tipo"
								class="w-full rounded bg-white p-2 text-gray-800"
							>
								<option value="todos">Perros, gatos, aves...</option>
								<option value="perros">Perros</option>
								<option value="gatos">Gatos</option>
							</select>
						</div>

						<div class="w-full">
							<label
								for="provincia"
								class="block text-sm font-semibold text-white"
								>Localización</label
							>
							<select
								id="provincia"
								class="w-full rounded bg-white p-2 text-gray-800"
							>
								<option value="todos">Todas</option>
								<option value="navarra">Navarra</option>
								<option value="álava">Álava</option>
								<option value="guipúzcoa">Guipúzcoa</option>
								<option value="vizcaya">Vizcaya</option>
							</select>
						</div>

						<div class="self-end">
							<button
								class="rounded bg-customBlue px-6 py-2 font-semibold text-white hover:bg-customBlueHover"
								id="buscar"
							>
								Buscar
							</button>
						</div>
					</div>
				</div>
			</section>

			<section class="mt-10 rounded-lg bg-purple-100 p-10">
				<h2
					class="mb-6 text-2xl font-bold text-gray-800"
					id="cantidad_resultados"
				>
					Sin resultados
				</h2>
				<div
					class="xs:grid-cols-1 grid gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6"
					id="resultados_mascotas"
				></div>
			</section>
		</main>

		<footer class="bg-customBlack p-4 pl-4 text-white">
			<div class="mb-4 flex flex-col justify-evenly gap-4 sm:flex-row">
				<div class="font-roboto">
					<a href="../index.html" class="mb-4 flex items-center">
						<img
							src="../assets/img/logo.png"
							alt="logo de adoptame"
							class="h-10"
						/>
						<p class="ml-4 font-montserrat text-2xl font-bold">
							Adóptame, plataforma de adopción
						</p>
					</a>
					<div
						class="flex w-full flex-col justify-between sm:flex-row sm:items-center"
					>
						<p class="font-bold">Siguenos en nuestras redes sociales:</p>
						<div class="flex gap-2">
							<img class="h-8 w-8" src="../assets/img/facebook.png" alt="" />
							<img class="h-8 w-8" src="../assets/img/instagram.png" alt="" />
							<img class="h-8 w-8" src="../assets/img/twiter.png" alt="" />
							<img class="h-8 w-8" src="../assets/img/linkedin.png" alt="" />
							<img class="h-8 w-8" src="../assets/img/youtube.png" alt="" />
						</div>
					</div>
				</div>
				<div>
					<p class="font-bold">Horario de atención</p>
					<p>De Lunes a Sábado de 9 a 18 horas</p>
				</div>
				<div>
					<p class="font-bold">Contacto</p>
					<p>948000000</p>
					<p>info@adoptame.es</p>
				</div>
			</div>
			<div class="sm:text-center">
				<span>2024 ©Adóptame - Todos los derechos reservados</span>
			</div>
		</footer>

		<script>
			const obtenerValoresURLYRefrescarSelectores = () => {
				const params = new URLSearchParams(window.location.search)

				const idProtectora = params.get('idProtectora')
				const provincia = params.get('provincia')
				const categoria = params.get('categoria')
			}

			obtenerValoresURLYRefrescarSelectores()

			const mascotasDiv = document.querySelector('#resultados_mascotas')
			const cantidadResultadosH1 = document.querySelector(
				'#cantidad_resultados'
			)
			const buscarDiv = document.querySelector('#buscar')

			const tipoSelector = document.querySelector('#tipo')
			const provinciaSelector = document.querySelector('#provincia')

			const buscar = () => {
				const params = new URLSearchParams()

				if (tipoSelector.value !== 'todos') {
					params.append('categoria', tipoSelector.value)
				}
				if (provinciaSelector.value !== 'todos') {
					params.append('provincia', provinciaSelector.value)
				}

				const url = `http://localhost:3000/mascotas${params.toString() ? `?${params.toString()}` : ''}`

				fetch(url)
					.then((response) => response.json())
					.then(generarMascotas)
					.catch((error) => console.error('Error al obtener mascotas:', error))
			}

			buscarDiv.addEventListener('click', buscar)

			const generarMascotas = (mascotas) => {
				cantidadResultadosH1.textContent = `${mascotas.length} resultados`

				mascotasDiv.innerHTML = mascotas
					.map(
						(x) => `
							<div class="bg-white shadow-lg rounded-lg p-3">
								<img src="../assets/img/mascotas/${x.imagen}" alt="${x.nombre}" class="w-full h-48 object-cover rounded-md">
								<div class="p-4">
									<h3 class="text-lg font-semibold text-gray-900">${x.nombre}</h3>
									<ul class="mt-2 text-sm text-gray-500">
										<li><strong>Categoría:</strong> <span class="capitalize">${x.categoria}</span></li>
										<li><strong>Edad:</strong> ${x.edad} años</li>
										<li><strong>Prioridad:</strong> ${x.prioridad}</li>
									</ul>
									<p class="mt-2 text-gray-900 font-medium">${x.protectora}</p>
								</div>
							</div>
						`
					)
					.join('')
			}

			fetch('http://localhost:3000/mascotas')
				.then((response) => response.json())
				.then(generarMascotas)
		</script>
	</body>
</html>
